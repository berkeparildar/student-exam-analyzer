<!-- Global Alanlar: Her sınav için tek sefer girilecek -->
<div class="global-fields">
  <div class="form-group">
    <label for="globalStudentNames">Student Names (Max 15 chars per name, Split by line):</label>
    <textarea id="globalStudentNames" rows="5" [(ngModel)]="globalStudentNames" placeholder="Enter student names, 15 chars per name, split by line"></textarea>
  </div>
  <div class="form-group">
    <label for="globalExamType">Exam Type (A or B):</label>
    <textarea id="globalExamType" rows="5" [(ngModel)]="globalExamType" placeholder="Enter A or B for exam type"></textarea>
  </div>
</div>

<!-- Kursa özgü alanlar -->
<div *ngFor="let examInput of examInputs; let i = index" class="exam-input-group">
  <h3>Course Exam Input {{ i + 1 }}</h3>
  
  <!-- Course selection for each exam input -->
  <div class="form-group">
    <label for="course{{ i }}">Select a Course:</label>
    <select id="course{{ i }}" [(ngModel)]="examInputs[i].courseName">
      <option value="">-- Select Course --</option>
      <option *ngFor="let course of courses" [value]="course">{{ course }}</option>
    </select>
  </div>
  
  <div class="form-group">
    <label for="answerSheetA{{ i }}">Answer Sheet (A Type Exam):</label>
    <textarea id="answerSheetA{{ i }}" rows="5" [(ngModel)]="examInputs[i].answerSheetA" placeholder="Enter answer sheet details"></textarea>
  </div>
  
  <div class="form-group">
    <label for="questionReferenceA{{ i }}">Question Reference (A Type Exam):</label>
    <textarea id="questionReferenceA{{ i }}" rows="5" [(ngModel)]="examInputs[i].questionReferenceA" placeholder="Enter question locations"></textarea>
  </div>
  
  <div class="form-group">
    <label for="questionTopics{{ i }}">Enter Question Topics (One per Line, Max 30):</label>
    <textarea id="questionTopics{{ i }}" rows="5" [(ngModel)]="examInputs[i].questionTopics" placeholder="Copy-paste topics from Excel"></textarea>
  </div>
  
  <div class="form-group">
    <label for="studentAnswers{{ i }}">Student Answers (Split by line):</label>
    <textarea id="studentAnswers{{ i }}" rows="5" [(ngModel)]="examInputs[i].studentAnswers" placeholder="Enter student answers, split by line"></textarea>
  </div>
  
  <hr />
</div>

<button (click)="onSubmitAndDownload()">Download Excel Report</button>
